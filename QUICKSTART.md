# 🏞️ ParkRelief — 快速使用指南

## 概述
ParkRelief 是一個純前端 Web 應用，為高齡者在戶外（如公園）提供隨時隨地的按摩與健康紀錄解決方案。所有資料透過 GUN.js 去中心化資料庫同步。

---

## 🚀 快速開始

### 方式 1：直接在瀏覽器打開（無需伺服器）
```bash
# 在瀏覽器網址列輸入（或直接開啟檔案）
file:///workspaces/ah/index.html
file:///workspaces/ah/tests.html
```

### 方式 2：使用本地 HTTP 伺服器（推薦）
```bash
cd /workspaces/ah
python3 -m http.server 8000

# 在瀏覽器打開
http://localhost:8000/index.html
http://localhost:8000/tests.html
```

---

## 📱 主應用功能（index.html）

### 1. 按摩控制面板
- **開始按摩** ▶️: 點擊啟動
- **選擇部位**: 腰部 / 背部 / 肩頸
- **調整強度**: 滑桿 1-10 級
- **設定時間**: 預設 15 分鐘（可自訂）
- **停止按摩** ⏹️: 結束按摩
- **儲存紀錄** 💾: 保存到 GUN.js

### 2. 狀態顯示
- 當前狀態: 「未啟動」/「按摩中」/「已停止」
- 倒數計時: MM:SS 格式即時更新
- 同步狀態: 「同步中」/「同步成功」/「同步失敗」

### 3. 按摩紀錄
- 自動列表顯示所有按摩事件
- 包含：時間、部位、強度、時長、備註、同步狀態
- 「🔄 刷新紀錄」: 手動更新（如有多端同步）

### 4. 分享連結
- **🔗 分享連結**: 生成可複製的 URL
- 家人可用相同連結打開應用，實時同步查看最新紀錄

---

## 🧪 測試頁面（tests.html）

### 執行測試
1. 在瀏覽器打開 `http://localhost:8000/tests.html`
2. 頁面自動執行 Mocha 測試套組
3. 檢查測試結果：
   - 🟢 綠色 ✓ = 測試通過
   - 🔴 紅色 ✗ = 測試失敗

### 測試覆蓋範圍
- ✅ 事件物件建立（10 個測試）
- ✅ GUN 同步功能（6 個測試）
- ✅ UI 狀態管理（10 個測試）
- ✅ 計時器功能（3 個測試）
- ✅ 輔助函式（5 個測試）
- **總計**: 34 個測試

---

## 📊 使用案例

### 案例 1: 高齡者在公園緊急緩解疼痛
1. 打開應用 → 看到「開始按摩」按鈕
2. 點擊「開始按摩」
3. 選擇痛點部位（例如「腰部」）
4. 調整強度（例如「6 級」）
5. 確認時間（例如「15 分鐘」）
6. 頁面顯示「按摩中」與倒數計時
7. 時間到自動停止，點「儲存紀錄」
8. UI 顯示「同步成功」

### 案例 2: 家人遠端查看健康紀錄
1. 高齡者點「🔗 分享連結」複製 URL
2. 將連結傳給家人（Line、WhatsApp 等）
3. 家人點擊連結，打開同個應用
4. 實時看到最新的按摩紀錄與同步狀態

---

## 🔧 開發指南

### 檔案結構
```
/workspaces/ah/
├── PRD.md              # 產品需求規格書
├── AGENTS.md           # AI 接手指南
├── index.html          # 主應用
├── styles.css          # 樣式表
├── app.js              # 核心邏輯
├── tests.html          # 測試跑台
└── tests/
    └── tests.js        # 單元測試代碼
```

### 核心函式（app.js）
| 函式 | 說明 |
|------|------|
| `createPainEvent()` | 建立疼痛事件物件 |
| `saveToGUN()` | 儲存到 GUN.js |
| `loadFromGUN()` | 從 GUN 讀取事件 |
| `toggleMassageStatus()` | 切換按摩狀態 |
| `startTimer()` | 啟動計時 |
| `updateUIStatus()` | 更新 UI 狀態 |

### TDD 開發流程
1. **Red** 階段：在 `tests.js` 寫新測試（會失敗）
2. **Green** 階段：在 `app.js` 實作最小功能讓測試通過
3. **Refactor** 階段：改進代碼質量，確保測試仍通過

---

## 🐛 常見問題

### Q: GUN 同步失敗怎麼辦？
A: 
- 檢查網路連線
- 檢查瀏覽器控制台 (F12) 是否有錯誤
- GUN CDN 可能暫時無法存取，稍後重試
- 若持續失敗，可自建私有 GUN 節點

### Q: 如何在多個瀏覽器間同步資料？
A:
- 在應用中點「🔗 分享連結」
- 複製生成的 URL
- 在另一個瀏覽器/裝置打開該 URL
- 資料會自動同步（GUN 去中心化特性）

### Q: 為什麼測試失敗？
A:
- 檢查 `app.js` 中的函式是否正確實作
- 在瀏覽器開發工具 (F12) 查看 Console 日誌
- 確保 GUN 和 Mocha/Chai CDN 已正確載入

### Q: 如何新增功能？
A: 遵循 TDD 流程
1. 在 `tests/tests.js` 寫新測試
2. 執行 `tests.html` 看測試失敗（紅色）
3. 在 `app.js` 實作功能
4. 執行測試直到通過（綠色）
5. 整理代碼與註解

---

## 📞 技術支援

### 查看日誌
在瀏覽器按 **F12** 打開開發工具，查看 Console 標籤：
- `[ParkRelief]` — 應用生命週期日誌
- `[GUN]` — GUN.js 同步日誌
- `[UI]` — UI 狀態變化日誌
- `[Timer]` — 計時器日誌
- `[Handler]` — 事件處理日誌

### 查看詳細文檔
- **需求文檔**: `PRD.md`
- **接手指南**: `AGENTS.md`
- **代碼註解**: `app.js` 頂部與各函式

---

## 🎯 成功指標

應用已完成的功能：
- ✅ 純前端應用（無後端依賴）
- ✅ GUN.js 去中心化同步
- ✅ 高齡者友善的 UI（大按鈕、大字體、高對比度）
- ✅ 34 個自動化測試（Mocha + Chai）
- ✅ 完整文檔（PRD、AGENTS、本指南）
- ✅ 分享與多端協作機制

---

**版本**: 1.0 (MVP)  
**最後更新**: 2025-11-19  
**開發方法**: TDD (測試驅動開發)
